<% # cache monument do %>
  <% if monument.noupload %>
    <% icon = "greyIcon" %>
  <% elsif monument.tree %>
    <% if monument.with_photos %>
      <% if monument.quality || monument.featured %>
        <% icon = "goldTree" %>
      <% else %>
        <% icon = "blueTree" %>
      <% end %>
    <% else %>
      <% icon = "redTree" %>
    <% end %>
  <% elsif monument.is_castle %>
    <% if monument.with_photos %>
      <% if monument.quality || monument.featured %>
        <% icon = "goldCastle" %>
      <% else %>
        <% icon = "blueCastle" %>
      <% end %>
    <% else %>
      <% icon = "redCastle" %>
    <% end %>
  <% else %>
    <% if monument.with_photos %>
      <% if monument.quality || monument.featured %>
        <% icon = "goldIcon" %>
      <% else %>
        <% icon = "blueIcon" %>
      <% end %>
    <% else %>
      <% icon = "redIcon" %>
    <% end %>
  <% end %>

    <%= snake_case(monument.regione) %>.addLayer(L.marker(new L.LatLng(<%= monument.latitude %>, <%= monument.longitude %>), { title: "<%= monument.itemlabel %>", icon: <%= icon %> }).bindPopup('<%= image_tag "https://commons.wikimedia.org/w/thumb.php?f=#{monument.image}&w=300" unless monument.image.blank? %><%== '<br/>' unless monument.image.blank? %><%= link_to monument.itemlabel.upcase_first, show_path(id: monument.id) %>'));
<% # end %>